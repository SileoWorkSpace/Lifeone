@model  LifeOne.Models.AdminManagement.AEntity.VerifyPanOrVoterid
@using LifeOne.Models.Manager;

@{
    ViewBag.Title = "Verify Franchisee KYC";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";

}


<style>
    .hide {
        display: none;
    }
</style>


<div class="content">
    <!-- Start Content-->
    <div class="container-fluid">
        <div class="row page-titles">
            <div class="ptitle">
                <h4 class="mb-1 mt-0">Verify KYC</h4>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-12">
                <div class="card">
                    <div class="card-body">
                        <ul class="nav nav-tabs profile-tab" role="tablist">
                            <li class="nav-item"> <a class="nav-link " href="/VerifyFranchiseeKYC" role="tab">Verify KYC</a> </li>
                            <li class="nav-item"> <a class="nav-link" href="/VerifyFranchiseeKYC?Type=Approved" role="tab">Approved KYC</a> </li>
                            <li class="nav-item"> <a class="nav-link" href="/VerifyFranchiseeKYC?Type=Declined" role="tab">Declined KYC</a> </li>
                        </ul>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="alert alert-warning" style="color:#727272 !important">
                                    @using (Html.BeginForm("VerifyFranchiseeKYC", "AdminReport"))
                                    {
                                        <div class="row">
                                            <div class="col-12 col-md-2">
                                                <div class="form-group">
                                                    <label>Login Id</label>
                                                    <input type="text" name="LoginId" id="LoginID" placeholder="Enter Login Id" class="form-control">
                                                </div>
                                            </div>
                                            <div class="col-12 col-md-2">
                                                <div class="form-group">
                                                    <label>Mobile No</label>
                                                    <input type="text" name="Mobile" id="Mobile" placeholder="Enter Mobile No" class="form-control" maxlength="10" onkeypress="return isNumberKey(event)">
                                                </div>
                                            </div>
                                            <div class="col-12 col-md-2">
                                                <div class="form-group">
                                                    <label>PAN No</label>
                                                    <input type="text" name="PanCard" id="PanCard" placeholder="Enter PAN No" class="form-control">
                                                </div>
                                            </div>
                                            <div class="col-12 col-md-2">
                                                <div class="form-group">
                                                    <label style="display:block;"></label>
                                                    <input type="submit" class="btn btn-success " style="margin-top:1.5em;" value="Search" id="BtnSearch">
                                                    <a href="/VerifyFranchiseeKYC" class="btn btn-secondary" style="margin-top:1.5em;">Reset</a>
                                                </div>
                                            </div>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                        <div class="tab-content">
                            <div class="tab-pane active" role="tabpanel">
                                <div class="table-responsive">
                                    <table class="table table-striped table-bordered" style="width:100%" id="example">
                                        <thead>
                                            <tr>
                                                <th>#Sn.</th>
                                                <th>Name</th>
                                                <th>Login Id</th>
                                                <th>Mobile No.</th>
                                                <th>PAN Card</th>
                                                <th>Aadhar Front</th>
                                                <th>Aadhar Back</th>
                                                <th>Bank</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @if (Model != null)
                                            {
                                                if (Model.List != null)
                                                {
                                                    int sno = 0;
                                                    var IsPan = "";
                                                    var IsAddress = "";
                                                    var IsAddressBack = "";
                                                    var IsBank = "";

                                                    int page = Model.Pager.CurrentPage;
                                                    page = (page - 1);
                                                    sno = ((page) * (Model.Pager.PageSize));

                                                    foreach (var item in Model.List)
                                                    {

                                                        IsPan = "Pan" + @item.Fk_MemId.ToString();
                                                        IsAddress = "Address" + @item.Fk_MemId.ToString();
                                                        IsAddressBack = "AddressBack" + @item.Fk_MemId.ToString();
                                                        IsBank = "Bank" + @item.Fk_MemId.ToString();

                                                        <tr>
                                                            <td align="left">@(sno = sno + 1)</td>
                                                            <td align="left"><span>@item.Name</span></td>
                                                            <td align="left"><span>@item.LoginId</span></td>
                                                            <td align="left"><span>@item.Mobile</span></td>

                                                            <td align="center">

                                                                @if (item.PanCardStatus == "P")
                                                                {
                                                                    <input type="hidden" id="IsPanApproved" />
                                                                    <input type="hidden" id="IsAddressApproved" />
                                                                    <input type="hidden" id="IsAddressBackApproved" />
                                                                    <input type="hidden" id="IsBankApproved" />

                                                                    <img src="@item.PanImage" onclick="OpenPanModal('@item.PanCard', '@item.PanImage')" style="height:50px;width:50px;" />

                                                                    <br />
                                                                    <span class="badge badge-warning">Pending</span>
                                                                    <input type="checkbox" id="@IsPan" />

                                                                }

                                                                else if (item.PanCardStatus == "A")
                                                                {
                                                                    <img src="@item.PanImage" onclick="OpenPanModal('@item.PanCard','@item.PanImage')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-success">Approved</span>


                                                                }
                                                                else
                                                                {
                                                                    <img src="@item.PanImage" onclick="OpenPanModal('@item.PanCard','@item.PanImage')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-danger">Declined</span>
                                                                }

                                                            </td>

                                                            <td align="center">

                                                                @if (item.AddressProofStatus == "P")
                                                                {
                                                                    <img src="@item.AadharImage" onclick="OpenAadharModal('@item.AadharImage','@item.AadharNumber')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-warning">Pending</span>
                                                                    <input type="checkbox" id="@IsAddress" />
                                                                }

                                                                else if (item.AddressProofStatus == "A")
                                                                {
                                                                    <img src="@item.AadharImage" onclick="OpenAadharModal('@item.AadharImage','@item.AadharNumber')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-success">Approved</span>
                                                                }
                                                                else
                                                                {
                                                                    <img src="@item.AadharImage" onclick="OpenAadharModal('@item.AadharImage','@item.AadharNumber')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-danger">Declined</span>
                                                                }

                                                            </td>
                                                            <td align="center">

                                                                @if (item.AddressProofBackStatus == "P")
                                                                {
                                                                    <img src="@item.AadharBackImage" onclick="OpenAadharModal('@item.AadharBackImage','@item.AadharNumber')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-warning">Pending</span>
                                                                    <input type="checkbox" id="@IsAddressBack" />
                                                                }
                                                                else if (item.AddressProofBackStatus == "A")
                                                                {
                                                                    <img src="@item.AadharBackImage" onclick="OpenAadharModal('@item.AadharBackImage','@item.AadharNumber')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-success">Approved</span>
                                                                }
                                                                else
                                                                {
                                                                    <img src="@item.AadharBackImage" onclick="OpenAadharModal('@item.AadharBackImage','@item.AadharNumber')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-danger">Declined</span>
                                                                }

                                                            </td>

                                                            <td align="center">
                                                                @if (item.BankStatus == "P")
                                                                {

                                                                    <img src="@item.BankImage" onclick="OpenBankModal('@item.BankImage', '@item.BankName', '@item.AccountHolder', '@item.AccountNumber', '@item.IfscCode')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-warning">Pending</span>

                                                                    <input type="checkbox" id="@IsBank" />


                                                                }

                                                                else if (item.BankStatus == "A")
                                                                {
                                                                    <img src="@item.BankImage" onclick="OpenBankModal('@item.BankImage', '@item.BankName', '@item.AccountHolder', '@item.AccountNumber', '@item.IfscCode')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-success">Approved</span>
                                                                }
                                                                else
                                                                {
                                                                    <img src="@item.BankImage" onclick="OpenBankModal('@item.BankImage', '@item.BankName', '@item.AccountHolder', '@item.AccountNumber', '@item.IfscCode')" style="height:50px;width:50px;" />
                                                                    <br />
                                                                    <span class="badge badge-danger">Declined</span>
                                                                }

                                                            </td>
                                                            <td align="left">

                                                                @if (item.AddressProofBackStatus == "P" || item.AddressProofStatus == "P" || item.BankStatus == "P" || item.PanCardStatus == "P")
                                                                {
                                                                    if (PermissionManager.IsActionPermit("Verify Franchisee KYC", ViewOptions.FormUpdate))
                                                                    {
                                                                        <a href="#" onclick="ApproveDeclineKYC(@item.Fk_MemId,'Approved')" style="padding: 5px 5px; font-size: 11px;" class="btn btn-success btn-sm">Approve</a>
                                                                        <a href="#" onclick="Decline(@item.Fk_MemId)" style="padding: 5px 5px; font-size: 11px;" class="btn btn-danger btn-sm">Decline</a>
                                                                    }
                                                                    <a href="javascript:void(0);" class="btn btn-warning btn-sm" style="padding: 5px 5px; font-size: 11px;" onclick="UploadKyc(@item.Fk_MemId);">Upload</a>
                                                                }
                                                                @if (item.AddressProofBackStatus == "A" && item.AddressProofStatus == "A" && item.BankStatus == "A" && item.PanCardStatus == "A")
                                                                {
                                                                    <a href="#" onclick="ApproveDeclineKYC(@item.Fk_MemId,'REKYC')" style="padding: 5px 5px; font-size: 11px;" class="btn btn-warning btn-sm">REKYC</a>
                                                                }
                                                            </td>


                                                        </tr>
                                                        //sno++;
                                                    }
                                                }
                                            }

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <footer class="card-footer bg-white p-2">
                                <div class="d-md-flex align-items-center justify-content-between">

                                    @if (Model != null)
                                    {
                                        if (Model.Pager != null)
                                        {
                                            if (Model.Pager.EndPage > 1)
                                            {
                                                <div> <small class="text-muted inline">showing @Model.List.Count  of @Model.List[0].TotalRecords items</small> </div>
                                                <div>
                                                    <ul class="pagination pagination-sm m-t-none m-b-none">
                                                        @if (Model.Pager.CurrentPage > 1)
                                                        {
                                                            <li class="page-item">
                                                                <a class="page-link" href="/VerifyFranchiseeKYC?Name=@Model.Name&LoginId=@Model.LoginId&Mobile=@Model.Mobile&PanCard=@Model.PanCard">First</a>
                                                            </li>
                                                            <li class="page-item">
                                                                <a class="page-link" href="/VerifyFranchiseeKYC?page=@(Model.Pager.CurrentPage - 1)&Name=@Model.Name&LoginId=@Model.LoginId&Mobile=@Model.Mobile&PanCard=@Model.PanCard">Previous</a>
                                                            </li>
                                                        }
                                                        @for (var page = Model.Pager.StartPage; page <= Model.Pager.EndPage; page++)
                                                        {
                                                            <li class="page-item @(page == Model.Pager.CurrentPage ? "active" : "")">
                                                                <a class="page-link" href="/VerifyFranchiseeKYC?page=@page&Name=@Model.Name&LoginId=@Model.LoginId&Mobile=@Model.Mobile&PanCard=@Model.PanCard">@page</a>
                                                            </li>
                                                        }
                                                        @if (Model.Pager.CurrentPage < Model.Pager.TotalPages)
                                                        {
                                                            <li class="page-item">
                                                                <a class="page-link" href="/VerifyFranchiseeKYC?page=@(Model.Pager.CurrentPage + 1)&Name=@Model.Name&LoginId=@Model.LoginId&Mobile=@Model.Mobile&PanCard=@Model.PanCard">Next</a>
                                                            </li>
                                                            <li class="page-item">
                                                                <a class="page-link" href="/VerifyFranchiseeKYC?page=@(Model.Pager.TotalPages)&Name=@Model.Name&LoginId=@Model.LoginId&Mobile=@Model.Mobile&PanCard=@Model.PanCard">Last</a>
                                                            </li>
                                                        }
                                                    </ul>
                                                </div>
                                            }
                                        }

                                    }

                                </div>
                            </footer>
                        </div>
                       
                    </div>

                   
                </div>
            </div>
        </div>

    </div>
    <!-- container-fluid -->

</div>


<div id="AadharModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <form>
            <div class="modal-content" style="width: 500px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Aadhar Card</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <img src="" id="AadharImage" class="form-control" style="height:400px;width:100%" />
                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Aadhar Number<em style="color:red">*</em></label>
                                <input type="text" readonly id="AadharNumber" class="form-control" />
                            </div>
                        </div>

                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </form>

    </div>
</div>

<div id="Pancard" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <form>
            <div class="modal-content" style="width: 500px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Pan Card </h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <img src="" id="Pancardurl" class="form-control" style="height:400px;width:100%" />
                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Pan Card Number<em style="color:red">*</em></label>
                                <input type="text" readonly id="PancardNo" class="form-control" />
                            </div>
                        </div>

                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </form>

    </div>
</div>

<div id="Bank" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <form>
            <div class="modal-content" style="width: 500px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Bank Document</h4>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <img src="" id="BankImage" class="form-control" style="height:400px;width:100%" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Account Holder<em style="color:red">*</em></label>
                                <input type="text" readonly id="AccountHolder" class="form-control" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Account Number<em style="color:red">*</em></label>
                                <input type="text" readonly id="AccountNumber" class="form-control" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Bank Name<em style="color:red">*</em></label>
                                <input type="text" readonly id="BankName" class="form-control" />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>IFSC Code<em style="color:red">*</em></label>
                                <input type="text" readonly id="IfscCode" class="form-control" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </form>

    </div>
</div>

<div id="DeclineKYC" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <form>
            <div class="modal-content" style="width: 500px;">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Decline KYC</h4>
                </div>
                <div class="modal-body">
                    <span id="Fk_MemId" class="hide"></span>
                    <span id="Type" class="hide"></span>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Remark<em style="color:red">*</em></label>
                                <textarea id="Remark" class="form-control"></textarea>
                            </div>
                        </div>

                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" onclick="ApproveDeclineKYC('','Declined')">Decline</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </form>

    </div>
</div>



<div id="EditUploadKyc" class="modal fade" role="dialog">
    <div class="modal-dialog modal-dialog modal-lg">
        <form>
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Edit Upload Kyc</h4>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="txtFk_MemId" />
                    <div class="row">
                        <div class="col-md-3">
                            <div class="col-md-12">
                                <div class="form-group" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                    <label>Upload PAN </label>
                                    <img src="" id="PAN" height="120" width="150">
                                </div>
                            </div>
                            <div class="col-md-12 divPan">
                                <div class="form-group">

                                    <input type="file" name="PanNo" id="PanNo" class="form-control" onchange="uploadFile('PAN', this);" />
                                    <input type="hidden" id="Panimagepath" />
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>PAN No</label>
                                    <input type="text" class="form-control" id="txteditPanNo" onchange="return ValidatePAN()" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="col-md-12">
                                <div class="form-group" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                    <label>Upload AADHAR </label>
                                    <img src="" id="AADHARFRONT" height="120" width="150">
                                </div>
                            </div>
                            <div class="col-md-12 divAadharFront">
                                <input type="file" name="AddressProofNo" id="AddressProofNo" class="form-control" onchange="uploadFile('AADHARFRONT', this);" />
                                <input type="hidden" id="AadharFrontimagepath" />
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Aadhar Number</label>
                                    <input type="text" class="form-control" id="txtediAddressProofNo" />
                                </div>
                            </div>

                        </div>
                        <div class="col-md-3">
                            <div class="col-md-12 ">
                                <div class="form-group" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                    <label>Upload AADHAR BACK </label>
                                    <img src="" id="AADHARBACK" height="120" width="150">
                                </div>
                            </div>
                            <div class="col-md-12 divAadharBack">
                                <input type="file" name="AddressProofFront" id="AddressProofFront" class="form-control" onchange="uploadFile('AADHARBACK', this);" />
                                <input type="hidden" id="AadharBackimagepath" />
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Bank A/c No</label>
                                    <input type="text" class="form-control" id="txteditBankAcNo" />
                                </div>
                            </div>

                        </div>
                        <div class="col-md-3">
                            <div class="col-md-12">
                                <div class="form-group" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                    <label>Upload BANK </label>
                                    <img src="" id="BANK" height="120" width="150">
                                </div>
                            </div>
                            <div class="col-md-12 divBank">

                                <input type="file" name="BankPassbook" id="BankPassbook" class="form-control" onchange="uploadFile('BANK', this);" />
                                <input type="hidden" id="Bankimagepath" />
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label>Ifsc Code</label>
                                    <input type="text" class="form-control" id="txtIfscCode" />
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="row" style="display: flex; flex-direction: row; align-items: center; justify-content: center;">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Bank Name</label>
                                <input type="text" class="form-control" id="txtBankname" />
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Account Holder</label>
                                <input type="text" class="form-control" id="txtaccountholder" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-success" onclick="return UpdateFranchiseeKyc();">Update</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </form>

    </div>
</div>

<script src="~/Content/dist/js/sweetalert.min.js"></script>
<script>
    $(document).ready(function () {
       
      
        $('#AADHARBACK').attr('src', '~/Content/WebsiteCss/assets/images/others/logo.png');
        $('#BANK').attr('src', '~/Content/WebsiteCss/assets/images/others/logo.png');
        $('#PAN').attr('src', '~/Content/WebsiteCss/assets/images/others/logo.png');
        $('#AADHARFRONT').attr('src', '~/Content/WebsiteCss/assets/images/others/logo.png');


    });

    function UploadKyc(fk_memid) {
        $('#EditUploadKyc').modal('show');
        $('#txtFk_MemId').val(fk_memid);

        $.ajax({

            url: '/Admin/AdminReport/GetFranchiseeKycDetails',
            data: { Fk_MemId: fk_memid, type: 'select' },
            dataType: 'json',
            type: 'GET',
            containtType: 'application/json;charset=utf-8',
            success: function (data) {
                if (data != null && data.Flag == "1") {
                    $('#txteditPanNo').val(data.PanCard);
                    $('#txtediAddressProofNo').val(data.AadharNumber);
                    $('#txteditBankAcNo').val(data.AccountNumber);
                    $('#txtIfscCode').val(data.IfscCode);
                    $('#txtBankname').val(data.BankName);
                    $('#txtaccountholder').val(data.AccountHolder);
                    if (data.PanImage != '~/Content/WebsiteCss/assets/images/others/logo.png') {
                        $('.divPan').css({ "display": "none" });
                        $('#txteditPanNo').attr("readonly", true);
                        $('#PAN').attr('src', data.PanImage);
                    }
                    else {
                        $('.divPan').css({ "display": "" });
                        $('#txteditPanNo').attr("readonly", false);
                       
                    }
                    if (data.AadharImage != '~/Content/WebsiteCss/assets/images/others/logo.png') {
                        $('.divAadharFront').css({ "display": "none" });
                        $('#txtediAddressProofNo').attr("readonly", true);
                        $('#AADHARFRONT').attr('src', data.AadharImage);
                    }
                    else {
                        $('.divAadharFront').css({ "display": "" });
                        $('#txtediAddressProofNo').attr("readonly", false);
                       

                    }
                    if (data.BankImage != '~/Content/WebsiteCss/assets/images/others/logo.png') {
                        $('.divBank').css({ "display": "none" });
                        $('#txteditBankAcNo').attr("readonly", true);
                        $('#txtIfscCode').attr("readonly", true);
                        $('#txtBankname').attr("readonly", true);
                        $('#txtaccountholder').attr("readonly", true);
                        $('#BANK').attr('src', data.BankImage);
                    }
                    else {
                        $('.divBank').css({ "display": "" });
                        $('#txteditBankAcNo').attr("readonly", false);
                        $('#txtIfscCode').attr("readonly", false);
                        $('#txtBankname').attr("readonly", false);
                        $('#txtaccountholder').attr("readonly", false);
                       
                    }
                    if (data.AadharBackImage != '~/Content/WebsiteCss/assets/images/others/logo.png') {
                        $('.divAadharBack').css({ "display": "none" });
                        $('#AADHARBACK').attr('src', data.AadharBackImage);
                    }
                    else {
                        $('.divAadharBack').css({ "display": "" });
                       
                    }

                }

            },
            error: function (error) {


            }

        });


    }



    function UpdateFranchiseeKyc() {
       
        if ($('#Panimagepath').val() != '') {
            if ($('#txteditPanNo').val() == '') {
                alert('Please enter Pan No');
                $('#txteditPanNo').focus();
                return false;
            }
        }
        if ($('#AadharFrontimagepath').val() != '') {
            if ($('#txtediAddressProofNo').val() == '') {
                alert('Please enter Aadhar no');
                $('#txtediAddressProofNo').focus();
                return false;
            }
        }
        if ($('#AadharBackimagepath').val() != '') {
            if ($('#txtediAddressProofNo').val() == '') {
                alert('Please enter Aadhar no');
                $('#txtediAddressProofNo').focus();
                return false;
            }
        }
        if ($('#Bankimagepath').val() != '') {
            if ($('#txteditBankAcNo').val() == '') {
                alert('Please enter Bank Account No');
                $('#txteditBankAcNo').focus();
                return false;
            }
            if ($('#txtIfscCode').val() == '') {
                alert('Please enter IFSC Code');
                $('#txtIfscCode').focus();
                return false;
            }
            if ($('#txtBankname').val() == '') {
                alert('Please enter Bank Name');
                $('#txtBankname').focus();
                return false;
            }
            if ($('#txtaccountholder').val() == '') {
                alert('Please enter Account Holder');
                $('#txtaccountholder').focus();
                return false;
            }
        }
        if ($('#Panimagepath').val() != '' || $('#AadharFrontimagepath').val() != '' || $('#AadharBackimagepath').val() != '' || $('#Bankimagepath').val() != '') {
            $.ajax({
                url: '/Admin/AdminReport/AdminUploadFranchiseeKyc',
                data: {
                    Fk_MemId: $('#txtFk_MemId').val(), PanCardNo: $('#txteditPanNo').val(), AddressProofNo: $('#txtediAddressProofNo').val(),
                    IfscCode: $('#txtIfscCode').val(), BankName: $('#txtBankname').val(), AccountHolder: $('#txtaccountholder').val(),
                    BankACNo: $('#txteditBankAcNo').val(), AddressFrontUrl: $('#AadharFrontimagepath').val(), AddressBackUrl: $('#AadharBackimagepath').val(),
                    PanUrl: $('#Panimagepath').val(), BankUrl: $('#Bankimagepath').val()
                },
                dataType: 'json',
                type: 'GET',
                containtType: 'application/json;charset=utf-8',
                success: function (data) {
                    if (data != null && data != "") {
                        if (data.Code == 1) {
                            swal('', data.Remark, 'success');
                            window.setTimeout(function () {
                                window.location.href = "/VerifyFranchiseeKYC";
                            }, 1000);
                        }
                        else {
                            swal('', data.Remark, 'success');
                            window.setTimeout(function () {
                                window.location.href = "/VerifyFranchiseeKYC";
                            }, 1000);
                        }
                    }
                }
            });
        }
        else {
            swal('', 'Please Upload Any Document', 'warning');
        }


    }


    function uploadFile(documentType, fileobj) {


        var fileInput = fileobj;
        if (fileInput.files.length === 0) {
            return;
        }
        var file = fileInput.files[0];
        var formData = new FormData();
        formData.append("documentType", documentType);
        formData.append("file", file);
        $.ajax({
            url: "/api/Image/UploadFranchiseeKyc",
            data: formData,
            processData: false,
            type: 'POST',
            contentType: false,
            success: function (data) {
                if (data.response == "success") {

                    if (documentType == "PAN") {
                        $('#Panimagepath').val(data.filepath);
                        ShowImagePreview(fileobj, documentType);
                    }
                    else if (documentType == "AADHARFRONT") {
                        $('#AadharFrontimagepath').val(data.filepath);
                        ShowImagePreview(fileobj, documentType);
                    }
                    else if (documentType == "AADHARBACK") {
                        $('#AadharBackimagepath').val(data.filepath)
                        ShowImagePreview(fileobj, documentType);
                    }
                    else if (documentType == "BANK") {
                        $('#Bankimagepath').val(data.filepath);
                        ShowImagePreview(fileobj, documentType);
                    }

                    else {
                        alert(data.msg);
                    }
                }
            }
        });
    }

    function OpenAadharModal(AadharImage, AadharNumber) {

        $("#AadharModal").modal("show");
        if (AadharImage != '') {
            $('#AadharImage').attr('src', AadharImage.replace('~/', '/'));
        }
        else {
            $('#AadharImage').attr('src', '~/Content/WebsiteCss/assets/images/others/logo.png');
        }
        $('#AadharNumber').val(AadharNumber);
    }
    function OpenPanModal(PanCard, PanCardURL) {
        $("#Pancard").modal("show");
        if (PanCardURL != '') {
            $('#Pancardurl').attr('src', PanCardURL.replace('~/', '/'));
        }
        else {
            $('#Pancardurl').attr('src', '~/Content/WebsiteCss/assets/images/others/logo.png');
        }
        $('#PancardNo').val(PanCard);
    }
    function OpenBankModal(BankImage, BankName, AccountHolder, AccountNumber, IfscCode) {
        $("#Bank").modal("show");
        if (BankImage != '') {
            $('#BankImage').attr('src', BankImage.replace('~/', '/'));
        }
        else {
            $('#BankImage').attr('src', '~/Content/WebsiteCss/assets/images/others/logo.png');
        }
        $('#BankName').val(BankName);
        $('#AccountHolder').val(AccountHolder);
        $('#AccountNumber').val(AccountNumber);
        $('#IfscCode').val(IfscCode);
    }
    function isNumberKey(evt) {
        var charCode = (evt.which) ? evt.which : event.keyCode;
        if (charCode != 46 && charCode > 31
            && (charCode < 48 || charCode > 57))
            return false;
    }
    function IsValidKYC(Fk_MemId) {
        var isValid = true;
        var IsPan = "";
        var IsAddress = "";
        var IsAddressBack = "";
        var IsBank = "";
        if ($("#Pan" + Fk_MemId).prop("checked")) {
            IsPan = "false";
        }
        if ($("#Address" + Fk_MemId).prop("checked")) {
            IsAddress = "false";
        }
        if ($("#AddressBack" + Fk_MemId).prop("checked")) {
            IsAddressBack = "false";
        }
        if ($("#Bank" + Fk_MemId).prop("checked")) {
            IsBank = "false";
        }
        if (IsPan == "" && IsAddress == "" && IsAddressBack == "" && IsBank == "") {
            isValid = false;
        }
        return isValid;
    }
    function Decline(Fk_MemId) {
        var res = IsValidKYC(Fk_MemId);
        if (res == false) {
            swal('', "Please Select Any Document ", 'warning');
            return false;
        }
        $("#DeclineKYC").modal("show");
        $('#Fk_MemId').val(Fk_MemId);
    }

    function ApproveDeclineKYC(Fk_MemId, Status) {
        var IsPan = "";
        var IsAddress = "";
        var IsAddressBack = "";
        var IsBank = "";
        var Remark = "";
        var id = "";

        if (Status == "REKYC") {
            IsPan = "true";
            IsAddress = "true";
            IsAddressBack = "true";
            IsBank = "true";
            Remark = "RE KYC by Admin";
            id = Fk_MemId;
        }
        if (Status == "Declined") {
            Remark = $('#Remark').val();
            if (Remark == "") {
                swal('', "Please Add Remark ", 'warning');
                return false;
            }
            id = $('#Fk_MemId').val();
        }
        if (Status == "Approved") {
            id = Fk_MemId;
            Remark = "Approved by Admin";
            var res = IsValidKYC(Fk_MemId);
            if (res == false) {
                swal('', "Please Select Any Document ", 'warning');
                return false;
            }
            if (confirm('Are you sure to approve this Request?') == false) {
                return false;
            }
        }
        if ($("#Pan" + id).prop("checked")) {
            IsPan = "true";
        }
        if ($("#Address" + id).prop("checked")) {
            IsAddress = "true";
        }
        if ($("#AddressBack" + id).prop("checked")) {
            IsAddressBack = "true";
        }
        if ($("#Bank" + id).prop("checked")) {
            IsBank = "true";
        }

        $.ajax({
            url: "/Admin/AdminReport/ApproveFranchiseeKYC",
            type: "Get",
            data: { Fk_MemId: id, Status: Status, Remark: Remark, IsPanApproved: IsPan, IsAddressApproved: IsAddress, IsAddressBackApproved: IsAddressBack, IsBankApproved: IsBank },
            dataType: 'json',
            containtType: 'application/json;charset=utf-8',
            success: function (data) {
                if (data != null && data != "") {
                    if (data.Flag == 1) {
                        $("#DeclineKYC").modal("hide");
                        swal('', data.Msg, 'success');
                        window.setTimeout(function () {
                            window.location.href = "/VerifyFranchiseeKYC";
                        }, 1000);
                    }
                    else {
                        swal('', data.Msg, 'success');
                        window.setTimeout(function () {
                            window.location.href = "/VerifyFranchiseeKYC";
                        }, 1000);
                    }
                }
            },
        });
    }
    function ValidatePAN() {
        var PanNo = $('#txteditPanNo').val()
        if (PanNo.value != "") {
            var panPattern = /^([a-zA-Z]{5})(\d{4})([a-zA-Z]{1})$/;
            if (PanNo.search(panPattern) == -1) {
                swal('', "Please enter valid pan number", 'warning');
                $('#txteditPanNo').val('');
                return false;
            }

        }
    }
    function ShowImagePreview(input, id) {

        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#' + id).prop('src', e.target.result);
            };
            reader.readAsDataURL(input.files[0]);

        }
    }
</script>